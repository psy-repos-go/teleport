---
title: Kubernetes Access from a Standalone Teleport Cluster
description: Connecting standalone Teleport installations to Kubernetes clusters.
---

Teleport can connect to external Kubernetes clusters without using the Teleport
Helm chart or running a pod inside of the Kubernetes cluster. To do this,
Teleport needs a `kubeconfig` file to authenticate against the Kubernetes API.

(!docs/pages/includes/permission-warning.mdx!)

## Prerequisites

<Tabs>
<TabItem scope={["oss"]} label="Open Source">

- A running Teleport cluster. For details on how to set this up, see one of our
  [Getting Started](../../getting-started.mdx) guides.

- **Optional:** the `tctl` admin tool version >= (=teleport.version=).

  ```code
  $ tctl version
  # Teleport v(=teleport.version=) go(=teleport.golang=)
  ```

  See [Installation](../../installation.mdx) for details.

  (!docs/pages/includes/tctl.mdx!)

</TabItem>
<TabItem
  scope={["enterprise"]} label="Enterprise">

- A running Teleport cluster. For details on how to set this up, see one of our
  [Getting Started](../../getting-started.mdx) guides.

- **Optional:** the `tctl` admin tool version >= (=teleport.version=), which you can download
  by visiting the
  [customer portal](https://dashboard.gravitational.com/web/login).

  ```code
  $ tctl version
  # Teleport v(=teleport.version=) go(=teleport.golang=)
  ```

  (!docs/pages/includes/tctl.mdx!)

</TabItem>
<TabItem scope={["cloud"]}
  label="Teleport Cloud">

- A Teleport Cloud account. If you do not have one, visit the
  [sign up page](https://goteleport.com/signup/) to begin your free trial.

- A host deployed on your own infrastructure to run the Teleport Kubernetes
  Service. See [Installing Teleport](../../installation.mdx) for more details.

- **Optional:** The `tctl` admin tool version >= (=teleport.version=).

  ```code
  $ tctl version
  # Teleport v(=teleport.version=) go(=teleport.golang=)
  ```

  See [Installation](../../installation.mdx) for details.

  (!docs/pages/includes/tctl.mdx!)

</TabItem>
</Tabs>

## Step 1/2. Generate a kubeconfig

First, configure your local `kubectl` command to point at the Kubernetes cluster
you want to register. You can use the following command to verify that
the correct cluster is selected:

```code
$ kubectl config get-contexts
```

Use this command to switch to the cluster assigned to `CONTEXT_NAME`:

```code
$ kubectl config use-context ${CONTEXT_NAME?}
```

Next, use [get-kubeconfig.sh](https://github.com/gravitational/teleport/blob/master/examples/k8s-auth/get-kubeconfig.sh) to create a `kubeconfig` for Teleport to use.

You can connect multiple Kubernetes clusters to Teleport from one `kubeconfig` if it contains multiple entries. Use
[merge-kubeconfigs.sh](https://github.com/gravitational/teleport/blob/master/examples/k8s-auth/merge-kubeconfigs.sh) to combine multiple `kubeconfigs` generated by `get-kubeconfig.sh`.

## Step 2/2. Add your kubeconfig to Teleport

<Tabs>
<TabItem scope={["oss", "enterprise"]} label="Self-Hosted">

In your Teleport Proxy, add the following to `teleport.yaml`, replacing
`example.com` with the domain name of your Teleport cluster:

```yaml
# ...
proxy_service:
  # ...
  public_addr: proxy.example.com:3080

  kube_listen_addr: 0.0.0.0:3026
  # optional: set a different public address for kubernetes access
  kube_public_addr: kube.example.com:3026

kubernetes_service:
  enabled: yes
  listen_addr: 0.0.0.0:3027
  # replace this path with the actual path for your generated kubeconfig
  kubeconfig_file: "path/to/kubeconfig"
```

</TabItem>
<TabItem scope={["cloud"]} label="Teleport Cloud">

On the host you will use to run the Teleport Kubernetes Service, add the
following to `teleport.yaml`.

```yaml
# ...
kubernetes_service:
  enabled: yes
  listen_addr: 0.0.0.0:3027
  # Replace this path with the actual path for your generated kubeconfig
  kubeconfig_file: "path/to/kubeconfig"
```

</TabItem>
</Tabs>

<Admonition type="warning" title="Warning" >
  When using `kubeconfig_file`, EKS users may need to replace illegal characters in the `context` names.
  Supported characters are alphanumeric characters, `.`, `_`, and `-`. EKS typically includes `:` and `@`
  in their `kubeconfig` which are not allowed in Teleport.
</Admonition>

After Teleport starts with the above config, you should be able to see all new clusters using:

```code
$ tsh kube ls
# or
$ sudo tctl get kube_service
```
